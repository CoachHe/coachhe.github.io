# 一、HDFS定义

## 定义

HDFS是一个文件系统，用于存储文件，通过目录树来定位文件； 

## 特点 

它是分布式的，由很多服务器联合起来实现其功能，集群中的服务器有各自的角色。 

## 使用场景 

适合一次写入，多次读出的场景，且不支持文件的修改。适合用来做数据分析，并不适合用来做网盘应用。 



# 二、HDFS优缺点

## 优点

#### 1. 高容错性

1. 数据自动保存多个副本，通过增加副本的形式提高容错性。 
2. 某一个副本丢失以后，可以自动恢复 

#### 2. 适合处理大数据 

1. 数据规模：能够处理数据规模达到GB、TB甚至PB级别的数据 
2. 文件规模：能够处理百万规模以上的文件数量，数量相当之大 

#### 3. 可以构建在廉价机器上 

## 缺点

#### 1. 不适合低延时数据访问

#### 2. 无法高效对大量小文件进行存储 

1. 存储大量小文件的话，它会占用NameNode大量内存来做存储文件和快信息，这样是不可取的，因为NameNode的内存总是有限的。 
2. 小文件存储的寻址时间会超过读取时间。 

#### 3. 不支持并发写入,文件随机修改 

1. 一个文件只能有一个写,不允许多个线程同时写 
2. 仅支持数据追加,不支持文件的随机修改. 



# 三、HDFS组成架构

## NameNode（nn）：就是Master，它是一个主管，管理者 

1. 管理HDFS的名称空间 
2. 配置副本策略 
3. 管理数据块（Block）映射信息 
4. 处理客户端读写请求 

## DataNode：就是Slave，NameNode下达命令，DataNode执行实际的操作 

1. 存储实际的数据块 
2. 执行数据块的读/写操作 

## Client：就是客户端 

1. 文件切片。文件上传HDFS的时候，Client将文件切分成一个个的Block，然后进行上传 
2. 与NameNode交互，获取文件的位置信息。 
3. 与Data交互，去读或者写入数据 
4. Client提供一些命令来管理HDFS，比如NameNode格式化 
5. Client可以通过一些命令来访问HDFS，比如对HDFS增删改查等操作 

## Secondary Namenode：并非NameNode的热备。当NameNode挂掉的时候，它并不能马上替换NameNode并提供服务 

1. 辅助NameNode，分担其工作量个，比如定期合并Fsimage（镜像文件）和Edits（编辑日志），并推送给NameNode 
2. 在紧急情况下，可辅助恢复NameNode 

<img src="https://coachhe.oss-cn-shenzhen.aliyuncs.com/Hadoop/20201210160627.png" style="zoom:80%;" />

# 四、 HDFS文件块大小

## 文件块大小为128M的原因

<img src="https://coachhe.oss-cn-shenzhen.aliyuncs.com/Hadoop/20201210160648.png" style="zoom: 50%;" />

## 为什么块的大小不能过大或者过小

#### 1. 太小：  

增加寻址时间 

#### 2. 太大：  

从磁盘传输数据的时间会明显大于定位这个块开始位置所需的时间，导师程序在处理这块数据时会非常慢。 

#### 总结 

HDFS块的大小设置主要取决于硬盘传输速度。 